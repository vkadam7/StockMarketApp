<!DOCTYPE html>
<html>
    <head>
        <link rel = "stylesheet" href = "/static/stylesheets/styles.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    </head>
    <header>
        <div class = "login">
            <p><a method = "POST" href = "login">Login</a> or <a method = "POST" href = "register">Register</a></p>
        </div>
        <br>
        <div class = "navbar">
            <nav>
                <ul>
                    <li><a method = "POST" href = "home">Home</a></li>
                    <li><a method = "POST" href = "aboutus">About Us</a></li>
                    <li><a method = "POST" href = "information">Information</a></li>
                </ul>
            </nav>
            <form action="/stockSearch" method="post">
                <input type="search" name="searchTerm" placeholder="Find a stock..."
                        value="{{ request.form['searchTerm'] }}">
                <button>Search</button>
            </form>
        </div>
    </header>
    <body>
        <div class="stockDisplay">
            <h1>{{ stock['ticker'] }} - {{ stock['name'] }}</h1>
            <h3>Headquarters: {{ stock['headquarters'] }}</h3>
            <h3>Listed at: {{ stock['listedAt'] }}</h3>
            <canvas id="stockChart" width="900" height="400"></canvas>
            <script>
                var ctx = document.getElementById("stockChart").getContext("2d");
                var stockChart = new Chart(ctx, {
                    type: "line",
                    data: {
                        labels: {{ dates | safe }},
                        datasets: [{
                            label: "Stock values",
                            data: {{ avgs | safe }},
                            fill: false,
                            borderColor: "rgb(20, 100, 50)",
                            lineTension: 0
                        }]
                    },
                    options: {
                        display: true
                    }
                });
            </script>
        </div>        
        <form action="/changeView" method="post">
            <div class="stockUtilityBar">
                <div class="stockUtilityBarIcon">
                    <h3>Starting date:</h3>
                    <input type="dateInput" name="startDate" placeholder="yyyy-mm-dd" 
                        value="{{ request.form['startData'] }}">
                </div>
                <div class="stockUtilityBarIcon">
                    <h3>Ending date:</h3>
                    <input type="dateInput" name="endDate" placeholder="yyyy-mm-dd"
                        value="{{ request.form['endData'] }}">
                </div>
                <div class="stockUtilityBarIcon">
                    <h3>Timespan:</h3>
                    <select name="timespan" value="{{ request.form['timespan'] }}">
                        <option value="daily">Daily prices</option>
                        <option value="weekly">Weekly prices</option>
                        <option value="monthly">Monthly prices</option>
                    </select>
                </div>
                <div class="stockUtilityBarIcon">
                    <button type="submit">Show Range</button>
                </div>
            </div>
        </form>
    </body>
</html>